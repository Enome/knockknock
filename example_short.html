<!DOCTYPE html>
<html>
  <head>
    <script src='lib/knockout-1.3.0beta.debug.js' type='text/javascript'>
    </script>
    <script src='build/kk.js' type='text/javascript'></script>

    <script type='text/javascript'>
      var Required = window.validators.Required;
      var Max = window.validators.Max
      var Regex = window.validators.Regex;
      var Email = window.validators.Email
      var Number = window.validators.Number
      var Equals = window.validators.Equals

      var ViewModel = function(){

        // Observables
        this.required = ko.observable();
        this.max      = ko.observable();
        this.regex    = ko.observable();
        this.email    = ko.observable();
        this.number   = ko.observable();
        this.equals   = ko.observable();
        this.combination = ko.observable();

        // Validation
        this.validation = new Validation({
          required : new Required(),
          max      : new Max(5),
          regex    : new Regex( /[^/]+\d+/ ),
          email    : new Email(),
          number   : new Number(),
          equals   : new Equals( this.number ),
          combination : [ new Required(), new Email() ]
        }, this );


      }; 

      ViewModel.prototype.validate = function(){
        if( this.validation.validate() ){
          alert('Do ajaxy stuff');
        };
      };

      window.onload = function(){
        ko.applyBindings( new ViewModel() );
      };
    </script>

    <style type='text/css'>

      input {
        border: 1px solid silver;
        padding: 3px 5px;
        width: 250px;
      }

      label { display : block; }
      input.invalid { background-color: #ffe57d; }
      ul { color: #ff002b; }

    </style>

  </head>
  <body>

    <h1>Knock-knock Validation: Short Example</h1>

    <p>
      For more information check out: <a href='http://github.com/Enome/knockknock'>knockknock on Github</a>.
    </p>

    <script type='text/html' id='FormItem'>
      <label data-bind='text: name'></label>
      <input type='text' data-bind='value: $data.field, validateCss: $data.field' />
      <ul data-bind='foreach: $data.field.errors'>
        <li data-bind='text: $data'></li>
      </ul>
    </script>

    <p data-bind='template: { name : "FormItem", data : { field : required, name : "Required" } }'></p>
    <p data-bind='template: { name : "FormItem", data : { field : max, name : "Max" } }'></p>
    <p data-bind='template: { name : "FormItem", data : { field : regex, name : "Regex" } }'></p>
    <p data-bind='template: { name : "FormItem", data : { field : email, name : "Email" } }'></p>
    <p data-bind='template: { name : "FormItem", data : { field : number, name : "Number" } }'></p>
    <p data-bind='template: { name : "FormItem", data : { field : equals, name : "Equals ( evaluated against Number ) " } }'></p>
    <p data-bind='template: { name : "FormItem", data : { field : combination, name : "Required and Email" } }'></p>

    <p>
      <button data-bind='click: validate'>Validate</button>
    </p>

  </body>
</html>
